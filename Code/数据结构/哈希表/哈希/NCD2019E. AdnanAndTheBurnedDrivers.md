# ğŸ”—
<a href="https://codeforces.com/gym/102163/problem/E"><img src="https://s2.loli.net/2022/01/06/17kR6dVvMn5plqj.png"></a>

# ğŸ’¡
é¢˜ç›®æš—ç¤ºè¿‡**å›æ–‡ä¸²æ˜¯æ­£ç€è¯»å’Œåç€è¯»éƒ½ä¸€æ ·çš„ä¸²**  
è€Œè¿™é‡Œä¹Ÿæœ‰æ”¹æ•°ä¸€æ ·çš„å•ç‚¹ä¿®æ”¹å’ŒåŒºé—´æŸ¥è¯¢  
é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨å­—ç¬¦ä¸²  <img src="https://latex.codecogs.com/svg.image?\inline&space;Hash" title="\inline Hash" /> + çº¿æ®µæ ‘  
  
å­—ç¬¦ä¸²  <img src="https://latex.codecogs.com/svg.image?\inline&space;Hash" title="\inline Hash" /> ä¸ºä¸€ä¸ªæ­£è¯»  <img src="https://latex.codecogs.com/svg.image?\inline&space;Hash:s_1" title="\inline Hash" /> å’Œä¸€ä¸ªåæ¸  <img src="https://latex.codecogs.com/svg.image?\inline&space;Hash:s_2" title="\inline Hash:s_2" />ï¼Œå°†è¿™ä¸¤ä¸ªæ•°ç»„ä½œä¸ºçº¿æ®µæ ‘æ•°ç»„     
  
æˆ‘ä»¬å•ç‚¹ä¿®æ”¹çš„æ—¶å€™ä¹Ÿå°±æ˜¯é‡å¯æ‰€æœ‰è¿æ¥åˆ°è¿™ä¸ªç‚¹çš„æ®µå€¼ï¼Œè¿™ä¸ªå¤„ç†ä¸€ä¸ª  <img src="https://latex.codecogs.com/svg.image?\inline&space;pw" title="\inline pw" /> æ•°ç»„ä½œä¸º  <img src="https://latex.codecogs.com/svg.image?\inline&space;base" title="\inline base" /> çš„å¹‚  
ä¸€ä¸ªä¿®æ”¹ä¸­  

```cpp
s1[rt] = s1[rt << 1] * pw[r - mid] + s1[rt << 1 | 1] // æ­£è¯»å·¦è¾¹ä¹˜baseçš„æ¬¡æ•°å¹‚
s2[rt] = s2[rt << 1] + s2[rt << 1 | 1] * pw[mid - l + 1] // åè¯»å³è¾¹ä¹˜baseçš„æ¬¡æ•°å¹‚
``` 
  
ä¸€ä¸ªæŸ¥è¯¢ä¸­ï¼Œå°±å’Œçº¿æ®µæ ‘ä¸€æ ·è¦å¯¹äºæŸ¥è¯¢çš„æ®µå·¦å­æ ‘æŸ¥è¯¢å³å­æ ‘æŸ¥è¯¢  
å’Œä¸Šé¢æ³¨é‡ŠåŒç†ï¼Œè¿™é‡Œä¹Ÿè¦æ­£è¯»åè¯»å„è‡ªä¹˜å¹‚  

```cpp
// å½“ç„¶å¦‚æœæ•´ä¸ªåŒºé—´åœ¨å·¦ä¸€åŠç›´æ¥é€’å½’å·¦åŠè¾¹å³å¯ï¼Œå¦åˆ™å³åŠè¾¹
which ? ( Query ( l, mid, rt << 1, ql, mid, which ) + Query ( mid + 1, r, rt << 1 | 1, mid + 1, qr, which ) * pw[mid - ql + 1] ) % mod
      : ( Query ( l, mid, rt << 1, ql, mid, which ) * pw[qr - mid] + Query ( mid + 1, r, rt << 1 | 1, mid + 1, qr, which )) % mod; // whichï¼š0â€”â€”æ­£è¯»ï¼Œ1â€”â€”åè¯»
```     
  
è¿™æ ·æ“ä½œä¸‹æ¥ï¼Œæˆ‘ä»¬æ¯æ¬¡æŸ¥è¯¢çš„æ—¶å€™å¦‚æœè¿™ä¸ªæ®µé•¿æ˜¯å¥‡æ•°ï¼Œå°±å·®  <img src="https://latex.codecogs.com/svg.image?\inline&space;[l,mid]" title="\inline [l,mid]" /> çš„æ­£è¯»å’Œ  <img src="https://latex.codecogs.com/svg.image?\inline&space;[mid,r]" title="\inline [mid,r]" /> çš„åè¯»  
å¦åˆ™å·®  <img src="https://latex.codecogs.com/svg.image?\inline&space;[l,mid-1]" title="\inline [l,mid-1]" /> çš„æ­£å’Œ  <img src="https://latex.codecogs.com/svg.image?\inline&space;[mid+1,r]" title="\inline [mid+1,r]" /> çš„å  
æ¯”è¾ƒè¿™ä¸¤ä¸ªï¼Œå¦‚æœä¸€æ ·çš„è¯å°±æ˜¯å›æ–‡  

# <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const ll mod = 1e9 + 3;
const ll base = 131;
const ll N = 1e5 + 10;

ll n, m;
ll s1[N << 2], s2[N << 2];
char s[N];
ll pw[N];

inline void get_Pw () {
        pw[0] = 1;
        for ( ll i = 1; i < N; i ++ ) pw[i] = pw[i - 1] * base % mod;
}

inline void Update ( ll l, ll r, ll rt, ll id, ll c ) {
        if ( l == r ) {
                s1[rt] = s2[rt] = c;
                return;
        }

        ll mid = (l + r) >> 1;
        if ( id <= mid ) Update(l, mid, rt << 1, id, c);
        else             Update(mid + 1, r, rt << 1 | 1, id, c);
        s1[rt] = (s1[rt << 1] * pw[r - mid] + s1[rt << 1 | 1]) % mod;
        s2[rt] = (s2[rt << 1] + s2[rt << 1 | 1] * pw[mid - l + 1]) % mod;
}

inline ll Query ( ll l, ll r, ll rt, ll ql, ll qr, ll which ) { // 0:æ­£ï¼Œ1:å
         if ( l == ql && r == qr ) return which? s2[rt] : s1[rt];
         ll mid = (l + r) >> 1;
         if ( qr <= mid ) return Query ( l, mid, rt << 1, ql, qr, which );
         else if ( ql > mid ) return Query ( mid + 1, r, rt << 1 | 1, ql, qr, which );
         else return which? ( Query ( l, mid, rt << 1, ql, mid, which ) + Query ( mid + 1, r, rt << 1 | 1, mid + 1, qr, which ) * pw[mid - ql + 1] ) % mod
                          : ( Query ( l, mid, rt << 1, ql, mid, which ) * pw[qr - mid] + Query ( mid + 1, r, rt << 1 | 1, mid + 1, qr, which )) % mod;
}

inline void Solve () {
        scanf("%lld%lld", &n, &m);
        getchar();
        scanf("%s", s + 1);
        for ( ll i = 1; i <= n; i ++ ) Update(1, n, 1, i, s[i]);
        while ( m -- ) {
                ll op; scanf("%lld", &op);
                if ( op == 1 ) {
                        ll id; scanf("%lld", &id); 
                        getchar();
                        char c; scanf("%c", &c);
                        Update ( 1, n, 1, id, c );

                        s[id] = c;
                } else {
                        ll l, r; scanf("%lld%lld", &l, &r);
                        ll mid = (l + r) >> 1;
                        if ( l == r ) {
                                puts("Adnan Wins");
                        } else if ( (r - l + 1) & 1 ) {
                                puts(Query(1, n, 1, l, mid - 1, 0) == Query(1, n, 1, mid + 1, r, 1) ? "Adnan Wins" : "ARCNCD!");
                        } else {
                                puts(Query(1, n, 1, l, mid, 0) == Query(1, n, 1, mid + 1, r, 1) ? "Adnan Wins" : "ARCNCD!");
                        }
                }
        }
}

int main () {
        get_Pw();
        ll cass; scanf("%lld", &cass); while ( cass -- ) {
                Solve ();
        }
}
```
