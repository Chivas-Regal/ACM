# 🔗
<a href="https://www.luogu.com.cn/problem/P1445"><img src="https://i.loli.net/2021/11/24/YcGKu7R56ajZpVd.png"></a>

# 💡
这个柿子比较难看，我们化简一下  
 <img src="https://latex.codecogs.com/svg.image?\inline&space;\begin{aligned}\frac1x+\frac1y&=\frac1{n!}\\yn!+xn!&=xy\\xy-(x+y)n!&=0\\n!^2-(x+y)n!+xy&=n!^2\\(x+n!)(y+n!)&=n!^2\end{aligned}" title="\inline \begin{aligned}\frac1x+\frac1y&=\frac1{n!}\\yn!+xn!&=xy\\xy-(x+y)n!&=0\\n!^2-(x+y)n!+xy&=n!^2\\(x+n!)(y+n!)&=n!^2\end{aligned}" />   
  
令  <img src="https://latex.codecogs.com/svg.image?\inline&space;A=x+n!,\;B=y+n!" title="\inline A=x+n!,\;B=y+n!" />   
则  <img src="https://latex.codecogs.com/svg.image?\inline&space;AB=n!^2" title="\inline AB=n!^2" />   
 <img src="https://latex.codecogs.com/svg.image?\inline&space;A" title="\inline A" />  是整数则  <img src="https://latex.codecogs.com/svg.image?\inline&space;x" title="\inline x" />  也是整数， <img src="https://latex.codecogs.com/svg.image?\inline&space;B" title="\inline B" />  同理  
只要  <img src="https://latex.codecogs.com/svg.image?\inline&space;A" title="\inline A" />  是  <img src="https://latex.codecogs.com/svg.image?\inline&space;n!^2" title="\inline n!^2" />  的因数，那么  <img src="https://latex.codecogs.com/svg.image?\inline&space;B" title="\inline B" />  也会是  <img src="https://latex.codecogs.com/svg.image?\inline&space;n!^2" title="\inline n!^2" />  的因数  
那么这道题就变成了求  <img src="https://latex.codecogs.com/svg.image?\inline&space;n!^2" title="\inline n!^2" />  因数的个数  
  
由唯一分解定理我们知道，若  <img src="https://latex.codecogs.com/svg.image?\inline&space;n=\prod\limits_{p|n}p^a" title="\inline n=\prod\limits_{p|n}p^a" />   
那么  <img src="https://latex.codecogs.com/svg.image?\inline&space;n" title="\inline n" />  的因数个数就是  <img src="https://latex.codecogs.com/svg.image?\inline&space;\prod\limits_{p|a}(a+1)" title="\inline \prod\limits_{p|a}(a+1)" />   
  
由于是求  <img src="https://latex.codecogs.com/svg.image?\inline&space;n!^2" title="\inline n!^2" />  的因数  
我们可以对  <img src="https://latex.codecogs.com/svg.image?\inline&space;1\rightarrow&space;n" title="\inline 1\rightarrow&space;n" />  的每一个数都分解一下质因数  
然后让  <img src="https://latex.codecogs.com/svg.image?\inline&space;a" title="\inline a" />  乘  <img src="https://latex.codecogs.com/svg.image?\inline&space;2" title="\inline 2" />   
再唯一分解定理进行求解即可  


# <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const int mod = 1e9 + 7;
const int N = 1e6 + 10;

namespace Number {
        bool not_prime[N];
        vector<ll> prime;
        inline void Sieve () {
                not_prime[0] = not_prime[1] = 1;
                for ( int i = 2; i < N; i ++ ) {
                        if ( !not_prime[i] ) prime.push_back(i);
                        for ( ll j = 0; j < prime.size() && i * prime[j] < N; j ++ ) {
                                not_prime[i * prime[j]] = 1;
                                if ( i % prime[j] == 0 ) break;
                        }
                }
        }
} using namespace Number;



ll mp[N], n;

int main () {
        Sieve (); cin >> n;
        for ( int i = 1; i <= n; i ++ ) {
                int x = i;
                for ( int j = 0; j < prime.size() && prime[j] * prime[j] <= x; j ++ ) {
                        while ( x % prime[j] == 0 ) 
                                mp[prime[j]] += 2, 
                                x /= prime[j];
                }
                if ( x > 1 ) 
                        mp[x] += 2;
        }
        ll res = 1;
        for ( int i = 1; i <= n; i ++ ) res = res * (mp[i] + 1) % mod;
        cout << res << endl;
}
```
