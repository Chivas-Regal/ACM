# 🔗
<a href="https://www.luogu.com.cn/problem/P1447"><img src="https://i.loli.net/2021/11/16/S1IEUQGkWz4vB6d.png"></a>

# 💡
这个和仪仗队那个很像啊  
 <img src="https://latex.codecogs.com/svg.image?\inline&space;(i,j)" title="\inline (i,j)" /> 位置上的点它前面挡住的人数就是  <img src="https://latex.codecogs.com/svg.image?\inline&space;gcd(i,j)" title="\inline gcd(i,j)" />   
所以我们把柿子抽象出来  
 <img src="https://latex.codecogs.com/svg.image?\inline&space;\begin{aligned}main(n,m)=&\sum\limits_{i=1}^n\sum\limits_{j=1}^m(2*(i,j)-1)\\=&2\sum\limits_{i=1}^n\sum\limits_{j=1}^m(i,j)-nm\end{aligned}" title="\inline main(n,m)=\sum\limits_{i=1}^n\sum\limits_{j=1}^m2*gcd(i,j)-1)" />   
 对于  <img src="https://latex.codecogs.com/svg.image?\inline&space;solve(n,m)=\sum\limits_{i=1}^n\sum\limits_{j=1}^m(i,j)=\sum\limits_{k=1}^{mn}k\sum\limits_{i=1}^n\sum\limits_{j=1}^m[(i,j)=k]" title="\inline solve(n,m)=\sum\limits_{i=1}^n\sum\limits_{j=1}^m(i,j)=\sum\limits_{k=1}^{mn}k\sum\limits_{i=1}^n\sum\limits_{j=1}^m[(i,j)=k]" />   
 感性地莫反一下  
 <img src="https://latex.codecogs.com/svg.image?\inline&space;f(k)=\sum\limits_{i=1}^n\sum\limits_{j=1}^m[(i,j)=k]" title="\inline f(k)=\sum\limits_{i=1}^n\sum\limits_{j=1}^m[(i,j)=k]" />   
  <img src="https://latex.codecogs.com/svg.image?\inline&space;F(k)=\sum\limits_{i=1}^n\sum\limits_{j=1}^m[k|(i,j)]=\frac&space;nk\frac&space;mk" title="\inline F(k)=\sum\limits_{i=1}^n\sum\limits_{j=1}^m[k|(i,j)]=\frac nk\frac mk" />    
  <img src="https://latex.codecogs.com/svg.image?\inline&space;f(k)=\sum\limits_{d=1}^{\frac{mn}k}\mu(d)\frac&space;n{dk}\frac&space;m{dk}" title="\inline f(k)=\sum\limits_{d=1}^{\frac{mn}k}\mu(d)\frac n{dk}\frac m{dk}" />   
   
  <img src="https://latex.codecogs.com/svg.image?\inline&space;\begin{aligned}&solve(n,m)\\=&\sum\limits_{k=1}^{mn}k\sum\limits_{d=1}^{\frac&space;nk}\mu(d)\frac&space;n{dk}\frac&space;m{dk}\quad\quad&(T=dk)\\=&\sum\limits_{k=1}^{mn}k\sum\limits_{\frac&space;Tk}^{\frac&space;{mn}k}\mu(\frac&space;Tk)\frac&space;nT\frac&space;mT\\=&\sum\limits_{T=1}^{mn}\frac&space;nT\frac&space;mT\sum\limits_{k|T}k\mu(\frac&space;Tk)\end{aligned}" title="\inline \begin{aligned}&solve(n,m)\\=&\sum\limits_{k=1}^{mn}k\sum\limits_{d=1}^{\frac nk}\mu(d)\frac n{dk}\frac m{dk}\quad\quad&(T=dk)\\=&\sum\limits_{k=1}^{mn}k\sum\limits_{\frac Tk}^{\frac {mn}k}\mu(\frac Tk)\frac nT\frac mT\\=&\sum\limits_{T=1}^{mn}\frac nT\frac mT\sum\limits_{k|T}k\mu(\frac Tk)\end{aligned}" />     
  <img src="https://latex.codecogs.com/svg.image?\inline&space;\sum\limits_{k|T}k\mu(\frac&space;Tk)" title="\inline \sum\limits_{k|T}k\mu(\frac Tk)" />  感性地狄利克雷卷积一下  <img src="https://latex.codecogs.com/svg.image?\inline&space;=(\mu*Id)(T)=\phi(T)" title="\inline =(\mu*Id)(T)=\phi(T)" />   
  <img src="https://latex.codecogs.com/svg.image?\inline&space;=\sum\limits_{T=1}^{mn}\frac&space;nT\frac&space;mT\phi(T)" title="\inline =\sum\limits_{T=1}^{mn}\frac nT\frac mT\phi(T)" />   
   
数不大直接暴力跑就行  

# <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
namespace Number {
        const int N = 1e5 + 10;
        int phi[N];
        bool not_prime[N];
        vector<int> prime;

        inline void Sieve () {
                not_prime[0] = not_prime[1] = phi[1] = 1;
                for ( int i = 2; i < N; i ++ ) {
                        if ( !not_prime[i] ) 
                                prime.push_back(i),
                                phi[i] = i - 1;
                        for ( int j = 0; j < prime.size() && i * prime[j] < N; j ++ ) {
                                not_prime[i * prime[j]] = 1;
                                if ( i % prime[j] == 0 ) {
                                        phi[i * prime[j]] = phi[i] * prime[j];
                                        break;
                                } else phi[i * prime[j]] = phi[i] * (prime[j] - 1);
                        }
                }
        }
} using namespace Number;

int main () {
        Sieve ();
        int n, m; cin >> n >> m;
        ll res = 0;
        for ( int i = 1; i <= min (m, n); i ++ ) {
                res += (ll)(m / i) * (n / i) * phi[i];
        }
        cout << res * 2 - (ll)n * m << endl;
}
```
