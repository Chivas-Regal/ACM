# 🔗
<a href="https://www.luogu.com.cn/problem/P6055"><img src="https://i.loli.net/2021/10/23/SgjYq5Xhl9AiJaH.png"></a>

# 💡
<img src="https://latex.codecogs.com/svg.image?\begin{aligned}&\sum\limits_{i=1}^N\sum\limits_{j=1}^N\sum\limits_{p=1}^{\left&space;\lfloor&space;\frac&space;Nj\right&space;\rfloor}\sum\limits_{q=1}^{\left&space;\lfloor&space;\frac&space;Nj\right&space;\rfloor}[gcd(i,j)=1][gcd(p,q)=1]\\=&\sum\limits_{i=1}^N\sum\limits_{j=1}^N\sum\limits_{p=1}^N\sum\limits_{q=1}^N[gcd(i,j)=1]j[gcd(p,q)=j]\\=&\sum\limits_{i=1}^N\sum\limits_{p=1}^N\sum\limits_{q=1}^N[gcd(i,p,q)=1]\end{aligned}" title="\begin{aligned}&\sum\limits_{i=1}^N\sum\limits_{j=1}^N\sum\limits_{p=1}^{\left \lfloor \frac Nj\right \rfloor}\sum\limits_{q=1}^{\left \lfloor \frac Nj\right \rfloor}[gcd(i,j)=1][gcd(p,q)=1]\\=&\sum\limits_{i=1}^N\sum\limits_{j=1}^N\sum\limits_{p=1}^N\sum\limits_{q=1}^N[gcd(i,j)=1]j[gcd(p,q)=j]\\=&\sum\limits_{i=1}^N\sum\limits_{p=1}^N\sum\limits_{q=1}^N[gcd(i,p,q)=1]\end{aligned}" />  
令<img src="https://latex.codecogs.com/svg.image?f(k)=\sum\limits_{i=1}^N\sum\limits_{p=1}^N\sum\limits_{q=1}^N[gcd(i,p,q)=k]" title="f(k)=\sum\limits_{i=1}^N\sum\limits_{p=1}^N\sum\limits_{q=1}^N[gcd(i,p,q)=k]" />  
<img src="https://latex.codecogs.com/svg.image?F(k)=\sum\limits_{i=1}^N\sum\limits_{p=1}^N\sum\limits_{q=1}^N[k|gcd(i,p,q)]" title="F(k)=\sum\limits_{i=1}^N\sum\limits_{p=1}^N\sum\limits_{q=1}^N[k|gcd(i,p,q)]" />  
设<img src="https://latex.codecogs.com/svg.image?i'=\frac&space;ik,p'=\frac&space;pk,q'=\frac&space;qk" title="i'=\frac ik,p'=\frac pk,q'=\frac qk" />进行枚举倍数  
则<img src="https://latex.codecogs.com/svg.image?\begin{aligned}F(k)=\sum\limits_{i'=1}^{\left&space;\lfloor&space;\frac&space;Nk\right&space;\rfloor}\sum\limits_{p'=1}^{\left&space;\lfloor&space;\frac&space;Nk\right&space;\rfloor}\sum\limits_{q'=1}^{\left&space;\lfloor&space;\frac&space;Nk\right&space;\rfloor}1=\left&space;\lfloor&space;\frac&space;Nk\right&space;\rfloor^3\end{aligned}" title="\begin{aligned}F(k)=\sum\limits_{i'=1}^{\left \lfloor \frac Nk\right \rfloor}\sum\limits_{p'=1}^{\left \lfloor \frac Nk\right \rfloor}\sum\limits_{q'=1}^{\left \lfloor \frac Nk\right \rfloor}1=\left \lfloor \frac Nk\right \rfloor^3\end{aligned}" />  
根据<img src="https://latex.codecogs.com/svg.image?f(k)=\sum\limits_{k\mid&space;d}\mu(\frac&space;dk)F(d)" title="f(k)=\sum\limits_{k\mid d}\mu(\frac dk)F(d)" />  
设<img src="https://latex.codecogs.com/svg.image?d'=\frac&space;dk,d=d'k" title="d'=\frac dk,d=d'k" />枚举倍数  
<img src="https://latex.codecogs.com/svg.image?f(k)=\sum\limits_{d'=1}^{\left&space;\lfloor&space;\frac&space;Nk\right&space;\rfloor}\mu(d')F(d'k)=\sum\limits_{d'=1}^{\left&space;\lfloor&space;\frac&space;Nk\right&space;\rfloor}\mu(d')\left&space;\lfloor&space;\frac&space;N{d'k}\right&space;\rfloor^3" title="f(k)=\sum\limits_{d'=1}^{\left \lfloor \frac Nk\right \rfloor}\mu(d')F(d'k)=\sum\limits_{d'=1}^{\left \lfloor \frac Nk\right \rfloor}\mu(d')\left \lfloor \frac N{d'k}\right \rfloor^3" />  
本题让求<img src="https://latex.codecogs.com/svg.image?f(1)=\sum\limits_{d'=1}^N\mu(d')\left&space;\lfloor&space;\frac&space;N{d'}\right&space;\rfloor^3" title="f(1)=\sum\limits_{d'=1}^N\mu(d')\left \lfloor \frac N{d'}\right \rfloor^3" />  
那么公式出来了，剩下的就是杜教筛数论分块乱搞了  


# <img src="https://img-blog.csdnimg.cn/20210713144601841.png" >
```cpp
const ll N = 2e6 + 10;
const ll mod = 998244353;
namespace Number {
        bool notprime[N];
        vector<ll> prime;
        ll mu[N], sum[N];
        inline void Sieve () {
                mu[1] = notprime[1] = notprime[0] = 1;
                for ( ll i = 2; i < N; i ++ ) {
                        if ( !notprime[i] ) prime.push_back(i), mu[i] = -1;
                        for ( ll j = 0; j < prime.size() && i * prime[j] < N; j ++ ) {
                                notprime[i * prime[j]] = 1;
                                if ( i % prime[j] == 0 ) break;
                                mu[i * prime[j]] = -mu[i];
                        }
                }
                for ( ll i = 1; i < N; i ++ ) sum[i] = (sum[i - 1] + mu[i]) % mod;
        }
        inline ll g ( ll k, ll x ) { return k / (k / x); }

        map<ll, ll> S;
        inline ll SUM ( ll x ) {
                if ( x < N ) return sum[x];
                if ( S[x] ) return S[x];
                ll res = 1;
                for ( ll L = 2, R; L <= x; L = R + 1 ) {
                        R = min ( x, g(x, L) );
                        res = (res - (R - L + 1) * SUM(x / L) % mod + mod) % mod;
                } return S[x] = res;
        }
} using namespace Number;

int main () {
        Sieve();
        ll n, res = 0; cin >> n;
        for ( ll l = 1, r; l <= n; l = r + 1 ) {
                r = g(n, l);
                res = (res + (SUM(r) - SUM(l - 1) + mod) % mod * (n / l) % mod * (n / l) % mod * (n / l) % mod) % mod;
        }
        cout << res << endl;
}
```
